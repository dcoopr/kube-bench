---
controls:
version: 1.13
id: 1
text: "Master Node Security Configuration"
type: "master"
groups:
- id: 1.1
  text: "Additional security checks per v3 sec assessment"
  checks:
  - id: 1.1.1
    text: "Ensure the port 10250 is not open"
    audit: "curl http://127.0.0.1:10250/runningpods/"
    tests:
      test_items:
      - flag: "status 7"
        compare:
          op: has
          value: "status 7"
        set: false
    remediation: "Ensure this port is not open by removing port 10250."
    scored: true

  - id: 1.1.2
    text: "Check if primary account is root"
    audit: "whoami"
    tests:
      test_items:
      - flag: "root"
        compare:
          op: has
          value: "root"
        set: false
    remediation: "Root user should not be primary user for nodes"
    scored: false

  - id: 1.1.3
    text: "Test if etcd is accessible by single user (no RBAC)"
    tests:
      test_items:
      - flag: '--authorization-mode=RBAC'
        compare:
          op: has
          value: true
        set: true
    remediation: "Ensure RBAC is enabled to limit access to etcd"
    scored: false

  - id: 1.1.4
    text: "Check if service accounts are in use (therefore not only kubectl account)"
    audit: "cat /var/run/secrets/kubernetes.io/serviceaccount"
    tests:
      test_items:
      - flag: 'default'
        compare:
          op: has
          value: "default"
        set: true
    remediation: "Implement service accounts for CaaSPCtl componenents"
    scored: false  
